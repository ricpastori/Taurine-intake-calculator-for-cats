{"version":3,"file":"index.js","sources":["../dist-src/index.js"],"sourcesContent":["export const of = ((val) => val);\nexport const Union = (recOrFunc) => {\n    const record = typeof recOrFunc === 'function' ? recOrFunc(undefined) : recOrFunc;\n    // tslint:disable-next-line:prefer-object-spread\n    return Object.assign({\n        if: createUnpack(record),\n        match: (a, b) => (b ? evalMatch(a, b) : (val) => evalMatch(val, a)),\n        matchWith: (_other, // yep, it is only used to \"remember\" type\n        matchObj) => createMatchTupleFunction(matchObj),\n    }, createConstructors(record, typeof recOrFunc === 'function'));\n};\nconst createMatchTupleFunction = (matchObj) => {\n    const { default: def } = matchObj;\n    return function matchTuple(a, b) {\n        const { p0: valA, k: keyA } = a;\n        const { p0: valB, k: KeyB } = b;\n        if (keyA in matchObj) {\n            const inner = matchObj[keyA];\n            if (inner !== undefined && KeyB in inner) {\n                const matchedFunction = inner[KeyB];\n                if (matchedFunction !== undefined) {\n                    return matchedFunction(valA, valB);\n                }\n            }\n        }\n        return def(a, b);\n    };\n};\nconst evalMatch = (val, cases) => {\n    // first elem is always the key\n    const handler = cases[getKey(val)];\n    return handler ? invoke(val, handler) : cases.default && cases.default(val);\n};\nconst createConstructors = (rec, isGeneric) => {\n    const result = {};\n    // tslint:disable-next-line: forin\n    for (const key in rec) {\n        result[key] = createCtor(key, rec, isGeneric);\n    }\n    return result;\n};\nconst createCtor = (key, rec, isGeneric) => {\n    const val = rec[key];\n    // it means that it was constructed with of(null)\n    if (val === null) {\n        const frozenVal = Object.freeze(makeValue(key, undefined, undefined, undefined));\n        return isGeneric ? () => frozenVal : frozenVal;\n    }\n    // tslint:disable-next-line:no-if-statement\n    if (val !== undefined) {\n        const res = makeValue(key, val, undefined, undefined);\n        return (() => res);\n    }\n    return ((p0, p1, p2) => makeValue(key, p0, p1, p2));\n};\nconst createUnpack = (rec) => {\n    const result = {};\n    // tslint:disable-next-line:forin\n    for (const key in rec) {\n        result[key] = createUnpackFunc(key);\n    }\n    return result;\n};\nconst createUnpackFunc = (key) => ((val, f, els) => getKey(val) === key ? invoke(val, f) : els && els(val));\nconst makeValue = (k, p0, p1, p2) => ({\n    k,\n    p0,\n    p1,\n    p2,\n    a: arity(p0, p1, p2),\n});\nconst invoke = (val, f) => {\n    switch (val.a) {\n        case 0:\n            return f();\n        case 1:\n            return f(val.p0);\n        case 2:\n            return f(val.p0, val.p1);\n        case 3:\n            return f(val.p0, val.p1, val.p2);\n    }\n};\nconst getKey = (val) => val.k;\n// const getParams = (val: any) => val.p;\nconst arity = (p0, p1, p2) => p2 !== undefined ? 3 : p1 !== undefined ? 2 : p0 !== undefined ? 1 : 0;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvaW5kZXgudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBa0RBLE1BQU0sQ0FBQyxNQUFNLEVBQUUsR0FBVSxDQUFDLENBQUMsR0FBUSxFQUFFLEVBQUUsQ0FBQyxHQUFHLENBQVEsQ0FBQztBQThOcEQsTUFBTSxDQUFDLE1BQU0sS0FBSyxHQUFjLENBQzlCLFNBQWtDLEVBQ2xDLEVBQUU7SUFDRixNQUFNLE1BQU0sR0FDVixPQUFPLFNBQVMsS0FBSyxVQUFVLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBRSxTQUFnQyxDQUFDLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQztJQUU3RixnREFBZ0Q7SUFDaEQsT0FBTyxNQUFNLENBQUMsTUFBTSxDQUNsQjtRQUNFLEVBQUUsRUFBRSxZQUFZLENBQUMsTUFBTSxDQUFDO1FBQ3hCLEtBQUssRUFBRSxDQUFDLENBQU0sRUFBRSxDQUFPLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQVEsRUFBRSxFQUFFLENBQUMsU0FBUyxDQUFDLEdBQUcsRUFBRSxDQUFDLENBQUMsQ0FBQztRQUNuRixTQUFTLEVBQUUsQ0FDVCxNQUF3QixFQUFFLDBDQUEwQztRQUNwRSxRQUE0QyxFQUM1QyxFQUFFLENBQUMsd0JBQXdCLENBQUMsUUFBUSxDQUFDO0tBQ3hDLEVBQ0Qsa0JBQWtCLENBQUMsTUFBTSxFQUFFLE9BQU8sU0FBUyxLQUFLLFVBQVUsQ0FBQyxDQUNyRCxDQUFDO0FBQ1gsQ0FBQyxDQUFDO0FBRUYsTUFBTSx3QkFBd0IsR0FBRyxDQUsvQixRQUF3QyxFQUN4QyxFQUFFO0lBQ0YsTUFBTSxFQUFFLE9BQU8sRUFBRSxHQUFHLEVBQUUsR0FBRyxRQUFRLENBQUM7SUFDbEMsT0FBTyxTQUFTLFVBQVUsQ0FBQyxDQUFjLEVBQUUs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"],"names":[],"mappings":"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"}